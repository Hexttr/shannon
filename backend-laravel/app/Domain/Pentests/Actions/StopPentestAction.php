<?php

namespace App\Domain\Pentests\Actions;

use App\Models\Pentest;

class StopPentestAction
{
    public function execute(string $id): void
    {
        $pentest = Pentest::findOrFail($id);

        if ($pentest->status !== 'running') {
            throw new \RuntimeException('Пентест не запущен');
        }

        $pentest->update([
            'status' => 'stopped',
            'completed_at' => now(),
        ]);
    }
}

