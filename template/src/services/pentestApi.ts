import api from './api';
import type { Pentest, CreatePentestRequest, Vulnerability, Log } from '../types';

export const pentestApi = {
  getAll: async () => {
    const response = await api.get<{ data: Pentest[] }>('/pentests');
    return response;
  },

  create: async (data: CreatePentestRequest) => {
    const response = await api.post<{ data: Pentest }>('/pentests', data);
    return response;
  },

  start: async (id: string) => {
    const response = await api.post(`/pentests/${id}/start`);
    return response;
  },

  stop: async (id: string) => {
    const response = await api.post(`/pentests/${id}/stop`);
    return response;
  },

  delete: async (id: string) => {
    const response = await api.delete(`/pentests/${id}`);
    return response;
  },

  getVulnerabilities: async (pentestId: string) => {
    const response = await api.get<{ data: Vulnerability[] }>(`/pentests/${pentestId}/vulnerabilities`);
    return response;
  },

  getLogs: async (pentestId: string) => {
    const response = await api.get<{ data: Log[] }>(`/pentests/${pentestId}/logs`);
    return response;
  },
};

